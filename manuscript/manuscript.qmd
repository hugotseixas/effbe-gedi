---
title: "Using remote sensing data to estimate short term effects of fire over forest aboveground biomass in the brazilian amazon: effects are..."
author: 
  - name: Hugo Tameirão Seixas
    email: seixas.hugo@protonmail.com
    url: https://hugotseixas.com/
    affiliations:
      - name: State University of Campinas
toc: true
toc-title: Contents
format: 
  html:
    theme: lux
page-layout: article
bibliography: references.bib
csl: frontiers-in-ecology-and-the-environment.csl
link-citations: true
abstract: "The objective of this experiment is to estimate the effect of forest fire over the biomass of tropical rainforest in the brazillian amazon. The analysed aboveground biomass are predictions derived from Global Ecosystem Dynamics Investigation (GEDI) Level 4A (L4A) Version 2. The experimental design is based in the sampling areas of 25 hectares over the brazillian amazon biome, where burned forest areas are compared to intact forests. The fire estimates are derived from the Moderate Resolution Imaging Spectroradiometer (MODIS) Burned Area data product (MCD64A1 Version 6). We expect to estimate a distribution of effects for the entire biome, which will allow the discussion about its possible heterogeneity and confounders."
---

```{r}
#| include: false

library(DiagrammeR)

```

------------------------------------------------------------------------

# Introduction

The effect of fire over forests have already been estimated in different studies. A field study found effects after a single burning event, in which the biomass reduction increased with more occurrences of fires [@Martins2012]. Studies also reported how trees characteristics also influence the impact of fire over forests [@Rocha2013].

------------------------------------------------------------------------

# Objectives

The objectives of this project are:

- Estimate the effects of fire occurrence over tropical rain forest above ground biomass;

- Identify the main drivers of heterogeneity of the effects;

------------------------------------------------------------------------

# Materials and Methods

### Experiment Scopus

The experiment will be performed within the Brazilian boundaries of the Amazon biome, in which we will analyse its forests formations. The experiment will cover the period between 2000 to 2021. We will analyse forests formations of any characteristics, and forest fires of any characteristics. 

### Experiment Design

To estimate the effect of forest fires over forest formations, we are going to compare two different groups: the control group (NB), that are forest formations in which fire occurrence was not detected from 2010 to 2021 (in other words, we assume this area was not burned in this period); the event group (YB), that are forest formations in which fire occurrence was detected only in 2020, in the period between 2010 and 2021. We will calculate differences between both groups before and after 2020 (which is the year when the fire event occurred or not). 

To extract observations of each group, we will use land cover and fire occurrence data (@sec-datasource). Only a small subset of the whole data available is going to be used to make inferences, and will be performed by a sampling scheme. The sampling scheme will consist of four steps: 1. randomly assign rectangles of ~10000km² inside the Brazilian Amazon biome, spaced at least by ~100km between each other, these are going to be named major sample cells (MaC); 2. randomly assign one rectangle of ~100km² inside each MaC, these are going to be named minor sample cells (MiC); 3. randomly assign 100 rectangles of ~0.25km² (50 NB rectangles and 50 YB rectangles) inside each MiC, NB rectangles will have to be at least 2km far from YB rectangles, these will be named observation cells (ObC); 4. extract values inside each ObC. This process will be repeat 100 times, in which we will shift the MaC positions to ensure more heterogeneity between sampling rounds.

We are going to use the following variables: above ground biomass, fire frequency, fire occurrence in 2020, experiment group, forest cover percentage inside burned pixel, fragmentation of the sampling rectangle, distance of observations to border. 

We will also apply a filter to the MiC, to avoid regions in which we don't have a lot of areas of internet (areas where we can sample NB and YB observations). The rule will be that apt areas for both experiment groups should cover at least 30% of the MiC, each.

The experiment overview diagram in @fig-expdiag.

```{r}
#| label: fig-expdiag
#| echo: false
#| fig-cap: "Experiment design diagram."
#| fig-alt: "This is a diagram"

grViz(
  "digraph expdiag {
  
  tooltip = ' '
  
  graph [layout = dot, rankdir = TD, nodesep = 0.1, ranksep = 1,tooltip = ' ']
  
  node [shape = box,
        fontname = Helvetica,
        style = filled,
        fontcolor = '#343a40'
        fillcolor = '#f7f7f9'
        penwidth = 2.2,
        width = 3,
        height = 1.5,
        fontsize = 20,
        tooltip = ' ']

  edge [arrowsize = 2,
        penwidth = 2.2,
        tooltip = ' ']

  a [label = 'LULC data']
  b [label = 'Fire data']
  c [label = 'AGB data']
  d [label = 'Treatment/Control \n samples']
  e [label = 'Distance to border']
  f [label = 'Fire occurrence']
  g [label = 'Forest cover']
  h [label = 'AGB loss']
  
  a -> d b -> d
  c -> h e -> h f -> h g -> d
  a -> g a -> e b -> f
  d -> h
  
  
  }"
)

```


![Experiment Design](exp_dsn.svg)

### Data processing


### Statistical analysis

To estimate the effect of fire occurrence over forest above ground biomass, we are using diff-in-diffs, by comparing the AGB values before and after the fire event, for control and experiment areas. We will use a ordinary least squares regression to perform the estimations. Since we are analyzing spatial data, there is a possibility of spatial auto correlation to affect our statistical model, so we will analyse the model residuals to detect possible spatial dependence between observations. If the autocorrelation are found to be true, we will apply spatial regressions to try to adjust the model for spatial dependence. By the end of the statistical analysis, each sampling rectangle will present a mean effect estimation.

To analyse the heterogeneity of the effects of fire over above ground forest biomass, we will aggregate the values of sampling rectangles off all sampling rounds in a course hexagonal figure. Each hexagonal cell will show an aggregated mean effect and the distribution of the mean effects of the sampling rectangles.

### Statistical model assumptions

### Data Sources {#sec-datasource}

The fire occurrences are going to be extracted from MODIS MCD64A1 [@Giglio_2015] Version 6 product, which provides world wide burned area estimates from 2000 to 2022. The spatial resolution is approximately 500 meters.

Forest cover will be represented by the Global Forest Change (1.9) [@Hansen_2013], which provide forest cover loss from 2000 to 2021. The spatial resolution is approximately 30 meters.

Biomass estimates will be provided by the GEDI L4A 2.1 Footprint Level Above ground Biomass Density product [@Dubayah_2022], with temporal extent from 2019 to 2022. The spatial resolution is approximately 25 meters.

### Literature

The discussion of our results are going to be discussed against a predefined literature. We performed a search in the Scopus database.

> TITLE-ABS-KEY((fire OR burn) W/10 (forest OR tree) W/10 (carbon OR biomass OR cover OR volume OR density)) AND TITLE-ABS-KEY(amazon) AND (LIMIT-TO(LANGUAGE, "English"))

The search returned 93 results, after screening (the strategy was to read titles and abstract, and select studies related to the estimation of the effect of fire occurrence over forest biomass).

The literature will serve, besides providing the theoretical foundation for the project development and future discussions, as a base to identify possible causes of forest above ground biomass loss. A DAG will be created with information obtained from the literature, and will be compared to the DAG of this experiment.

![Experiment Aggregation](exp_agg.svg)

All visualizations are going to be interactive and as accessible as possible.

Code and data will be publicly available, reproducibility will be facilitated as much as possible.

------------------------------------------------------------------------

# Results

### Statistical model

We can see two DAGs in the @fig-dags

```{r}
#| label: fig-dags
#| echo: false
#| fig-cap: "DAGs. TODO: need to put a title for each DAG"
#| fig-alt: "Two DAGs."

grViz(
  
  "digraph dags {
  
  tooltip = ' '
  
  graph [layout = dot, rankdir = TD, nodesep = 0.3, ranksep = 1, tooltip = ' ']
  
  edge [tooltip = ' ']
  
  node [shape = box,
        fontname = Helvetica,
        style = filled,
        fontcolor = '#343a40'
        fillcolor = '#f7f7f9'
        penwidth = 1.2,
        fixedsize = true,
        width = 0.8,
        height = 0.8,
        tooltip = ' ']
        
  a [label = < <B>Fire</B> >]
  b [label = < <B>AGB</B> >]
  1 [label = < <B>Fire</B> >]
  2 [label = < <B>AGB</B> >]
  
  node [shape = circle,
        fontname = Helvetica,
        style = filled,
        fontcolor = '#343a40'
        fillcolor = '#f7f7f9'
        penwidth = 1.2,
        fixedsize = true,
        width = 1,
        tooltip = ' ']
  
  d [label = SL] # Selective Logging
  e [label = TC] # Tree characteristics
  f [label = Drought]
  g [label = DTB]
  3 [label = Drought]
  4 [label = DTB]
  
  a -> b  
  d -> b
  e -> a e -> b
  f -> a f -> b
  g -> a g-> b g -> d
  

  
  
  1 -> 2
  3 -> 1 3 -> 2
  4 -> 2
  
  }"
  
)

```

### Effect of fire occurrence over forest above ground biomass

### Sources of effect heterogeneity

------------------------------------------------------------------------

# Discussion

------------------------------------------------------------------------

# Conclusions

------------------------------------------------------------------------

# Supporting Information

# References
